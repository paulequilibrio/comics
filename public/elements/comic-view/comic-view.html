<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<dom-module id="comic-view">
    <template>
        <style>
          :host {
            display: block;
          }
        </style>

        <iron-ajax
            auto
            url="{{host}}api/v1{{comicSource}}"
            handle-as="json"
            last-response="{{comic}}"
            debounce-duration="500">
        </iron-ajax>

        <h1>
            <span>{{comic.title}}</span>
        </h1>
        <h3>
            Comic published on {{date}} from <a href="{{comic.source}}">{{comic.author}}</a>
        </h3>
        <iron-image placeholder="/static/loading.gif" preload src="{{comic.comic}}"></iron-image>
    </template>

    <script>
      (function() {
      'use strict';
          Polymer({
              is: 'comic-view',
              properties: {
                  host: {
                      type: String,
                      notify: true
                  },
                  comicSource: {
                    type: String,
                    value: window.location.pathname
                  },
                  comic: {
                      type: Object,
                      notify: true
                  },
                  date: {
                      type: String,
                      computed: 'formatDate(comic.published)'
                  }
              },

              formatDate(published){
                  return moment(published).format('MMMM Do YYYY, h:mm a');
              },
          });
      })();
    </script>
</dom-module>
